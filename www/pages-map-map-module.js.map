{"version":3,"sources":["webpack:///./src/app/pages/map/map.module.ts","webpack:///./src/app/pages/map/map.page.html","webpack:///./src/app/pages/map/map.page.scss","webpack:///./src/app/pages/map/map.page.ts"],"names":[],"mappings":"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","file":"pages-map-map-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MapPage } from './map.page';\n// import { ThsMapComponent } from '../../../components/ths-map/ths-map';\nimport { ComponentsModule } from '../../../components/components.module';\nconst routes: Routes = [\n  {\n    path: '',\n    component: MapPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ComponentsModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [MapPage,]\n})\nexport class MapPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar [ngClass]=\\\"{'blue': skinName==='blue','green': skinName==='green','orange': skinName==='orange'}\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button text=\\\"\\\" icon=\\\"ios-arrow-back\\\" mode='ios'></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>所在位置</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div style=\\\"height: calc(100%);\\\">\\n    <ths-map (onMapLoaded)=\\\"onMapLoaded($event)\\\"></ths-map>\\n  </div>\\n</ion-content>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL21hcC9tYXAucGFnZS5zY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ActivatedRoute } from '@angular/router';\nimport { loadModules } from 'esri-loader'; // 地图API装载器\nimport { MapService } from '../../../components/ths-map/map.service';\nimport { ConfigService } from '../../services/public/config.service';\n\n\n@Component({\n  selector: 'app-map',\n  templateUrl: './map.page.html',\n  styleUrls: ['./map.page.scss'],\n})\nexport class MapPage implements OnInit {\n  skinName: string;\n  skinRgb: any;\n  title: any = '首页';//标题名称(默认为首页)\n  legendType = 3;//图例类型 1自行监测点位 2地块 3全部\n  backShow: boolean = false;//是否显示返回按钮\n  mapView;//地图视图\n  pointLayer;//监测点位图层\n  highlightLayer;//点位高亮图层\n  monitorPoints: any = [];//监测点位列表\n  landPointLayer;//地块点位图层\n  landPoints: any = [];//监测点位列表\n  graphicData: any = {};//点击点位时获取到的数据\n  monitorPopShow: boolean = false;//监测点位弹框是否显示\n  landPopShow: boolean = false;//地块弹框是否显示\n  longitude: any;//经度\n  latitude: any; //纬度\n  \n  constructor(\n    public mapService: MapService,\n    public config: ConfigService,\n    public router:Router,\n    public activatedRouted:ActivatedRoute\n  ) {\n    this.activatedRouted.queryParams.subscribe(params => {\n      this.longitude = params.longitude;\n      this.latitude = params.latitude;\n      //this.plotId = '7c43c589-70bb-4acb-b53e-bbf7cc6ba594';\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  ionViewWillEnter() {\n    //设置头部皮肤\n    this.skinName = localStorage.getItem('skinName') || 'blue';\n  }\n  \n   /**\n   * 地图加载完毕\n   * @param map \n   */\n  onMapLoaded(map) {\n    this.mapView = map;\n    this.mapService.setCenterAndZoom(map, this.longitude, this.latitude, 9); // 设置当前中心点\n\n    loadModules(['esri/geometry/Point', 'esri/layers/GraphicsLayer', 'esri/symbols/PictureMarkerSymbol', 'esri/graphic', 'esri/InfoTemplate'])\n      .then(([Point, GraphicsLayer, Graphic, InfoTemplate]) => {\n        this.pointLayer = new GraphicsLayer({ id: 'pointLayer' }); // 监测点位图层\n        this.mapView.addLayers([this.pointLayer]); // 把图层加入到地图中\n        this.addPoint( this.pointLayer, 1);\n      });\n\n    //地图的点击事件\n    this.mapView.on('click', (e) => {\n\n      if (e.graphic && e.graphic.attributes !== undefined) {//判断点击的是不是点\n\n        this.graphicData = e.graphic.attributes;//获取点的数据\n        \n        if (this.graphicData.pointType == '1') {\n          this.monitorPopShow = true;\n          this.landPopShow = false;\n        } else {\n          this.monitorPopShow = false;\n          this.landPopShow = true;\n        }\n\n      } else {\n        this.monitorPopShow = false;\n        this.landPopShow = false;\n        this.highlightLayer.clear();//清除之前打的点\n      }\n    })\n  }\n\n  /**\n  * 地图打点\n  * @param data 点位数据\n  * @param graphicsLayer 待添加的点所在的图层\n  * @param pointType 点位类型 1监测点位 2地块点位\n  */\n  addPoint(graphicsLayer, pointType) {\n\n    graphicsLayer.clear();\n    loadModules([\"esri/geometry/Point\", \"esri/layers/GraphicsLayer\", \"esri/symbols/PictureMarkerSymbol\", \"esri/graphic\", \"esri/InfoTemplate\"])\n    .then(([Point, GraphicsLayer, PictureMarkerSymbol, Graphic, InfoTemplate]) => {\n    \n        let point = new Point(this.longitude, this.latitude);\n        var img=\"../../../assets/img/index_location.png\";\n        let pictureMarkerSymbol = new PictureMarkerSymbol(img,18, 22.5);\n        // let infoTemplate = new InfoTemplate(template);\n\n        //创建Graphic\n        let graphicPic = new Graphic(point, pictureMarkerSymbol);\n        //图层增加图片点\n        graphicsLayer.add(graphicPic);\n     \n    });\n  }\n\n\n}\n"],"sourceRoot":""}